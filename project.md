# üß† PhotoFinder ‚Äî –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–°–∏—Å—Ç–µ–º–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –ª–∏—Ü –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π —Å –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π, 
—Å–æ–∑–¥–∞–Ω–∏—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –ø–æ–∏—Å–∫–∞ –≤—Å–µ—Ö —Å–Ω–∏–º–∫–æ–≤, –≥–¥–µ –æ–Ω–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç.  
–í–∫–ª—é—á–∞–µ—Ç –∞–¥–º–∏–Ω-–∑–∞–≥—Ä—É–∑–∫—É —Ñ–æ—Ç–æ, ML-–æ–±—Ä–∞–±–æ—Ç–∫—É, –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏ Telegram-–±–æ—Ç–∞ –¥–ª—è –∫–æ–Ω–µ—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

---

## üìÅ –§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
photofinder/
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ .env

‚îú‚îÄ‚îÄ app/                          # –û—Å–Ω–æ–≤–Ω–æ–π API —Å–µ—Ä–≤–∏—Å (FastAPI)
‚îÇ   ‚îú‚îÄ‚îÄ main.py                   # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (FastAPI)
‚îÇ   ‚îú‚îÄ‚îÄ config.py                 # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ db/                       # –†–∞–±–æ—Ç–∞ —Å –ë–î
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base.py               # SQLAlchemy init
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.py             # –û–ø–∏—Å–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü ORM
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ crud.py               # CRUD-–æ–ø–µ—Ä–∞—Ü–∏–∏ (users, photos...)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ migrations/           # Alembic –º–∏–≥—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ schemas/                  # Pydantic-—Å—Ö–µ–º—ã (–≤–∞–ª–∏–¥–∞—Ü–∏—è API)
‚îÇ   ‚îú‚îÄ‚îÄ routes/                   # –ú–∞—Ä—à—Ä—É—Ç—ã FastAPI
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ search.py             # /search
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin.py              # /admin/upload_batch
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ users.py              # /users/{id}/photos
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ embeddings.py         # –ò–Ω—Ñ–µ—Ä–µ–Ω—Å —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ faiss_index.py        # –û–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ FAISS
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ storage.py            # –†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–æ–≤—ã–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils.py              # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ workers/
‚îÇ       ‚îî‚îÄ‚îÄ enqueue.py            # –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á –≤ Redis

‚îú‚îÄ‚îÄ ml_worker/                    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –±–∞—Ç—á–µ–π (–≤–æ—Ä–∫–µ—Ä)
‚îÇ   ‚îú‚îÄ‚îÄ worker.py                 # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤–æ—Ä–∫–µ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ detector.py               # –î–µ—Ç–µ–∫—Ü–∏—è –ª–∏—Ü (RetinaFace)
‚îÇ   ‚îú‚îÄ‚îÄ aligner.py                # –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ª–∏—Ü
‚îÇ   ‚îú‚îÄ‚îÄ embedder.py               # –≠–∫—Å—Ç—Ä–∞–∫—Ü–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ clusterizer.py            # –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –ª–∏—Ü (DBSCAN)
‚îÇ   ‚îú‚îÄ‚îÄ updater.py                # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î + FAISS
‚îÇ   ‚îú‚îÄ‚îÄ quality.py                # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ (—Ä–∞–∑–º—ã—Ç–∏–µ, –ø–æ–∑–∞)
‚îÇ   ‚îî‚îÄ‚îÄ utils/                    # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)

‚îú‚îÄ‚îÄ bot/                          # Telegram –±–æ—Ç
‚îÇ   ‚îú‚îÄ‚îÄ main.py                   # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ aiogram
‚îÇ   ‚îú‚îÄ‚îÄ handlers.py               # –•—ç–Ω–¥–ª–µ—Ä—ã —Å–æ–æ–±—â–µ–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ api_client.py             # –û–±—Ä–∞—â–µ–Ω–∏–µ –∫ API
‚îÇ   ‚îî‚îÄ‚îÄ keyboards.py              # –ö–Ω–æ–ø–∫–∏ –∏ –º–µ–Ω—é

‚îú‚îÄ‚îÄ scripts/                      # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ init_db.py                # –ü–µ—Ä–≤–∏—á–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü
‚îÇ   ‚îú‚îÄ‚îÄ rebuild_faiss.py          # –ü–µ—Ä–µ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞
‚îÇ   ‚îú‚îÄ‚îÄ load_from_yadisk.py       # –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ —Å –Ø.–î–∏—Å–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ import_batch.py           # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–∞—Ç—á–∞ –≤ –æ—á–µ—Ä–µ–¥—å

‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ photos/                   # –•—Ä–∞–Ω–∏–ª–∏—â–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ raw_uploads/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ users/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ thumbnails/
‚îÇ   ‚îú‚îÄ‚îÄ faiss/
‚îÇ   ‚îî‚îÄ‚îÄ temp/

‚îî‚îÄ‚îÄ tests/
    ‚îú‚îÄ‚îÄ test_api.py
    ‚îú‚îÄ‚îÄ test_worker.py
    ‚îî‚îÄ‚îÄ test_bot.py

```

---

## üß© –ö–ª—é—á–µ–≤—ã–µ –º–æ–¥—É–ª–∏ –∏ –∏—Ö –∑–∞–¥–∞—á–∏

### `app/` ‚Äî API-—Å–µ—Ä–≤–∏—Å
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –æ—Ç Telegram-–±–æ—Ç–∞ –∏ –∞–¥–º–∏–Ω–∫–∏.  
- –î–µ–ª–∞–µ—Ç –±—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –ø–æ FAISS.  
- –†–∞–±–æ—Ç–∞–µ—Ç —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö (PostgreSQL).  
- –§–æ—Ä–º–∏—Ä—É–µ—Ç –∏ —Å—Ç–∞–≤–∏—Ç –∑–∞–¥–∞—á–∏ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –Ω–æ–≤—ã—Ö —Ñ–æ—Ç–æ –≤ Redis.

| –§–∞–π–ª                      | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç                                                                              |
| ------------------------- | --------------------------------------------------------------------------------------- |
| `main.py`                 | –°–æ–∑–¥–∞—ë—Ç FastAPI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –ø–æ–¥–∫–ª—é—á–∞–µ—Ç –º–∞—Ä—à—Ä—É—Ç—ã, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç FAISS –∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –ë–î |
| `config.py`               | –ó–∞–≥—Ä—É–∂–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–ø–æ—Ä—Ç—ã, –ø—É—Ç–∏, –∫–ª—é—á–∏)                                     |
| `db/models.py`            | ORM-–º–æ–¥–µ–ª–∏ (`Photo`, `Face`, `User`, `UserPhoto`)                                       |
| `db/crud.py`              | –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –ë–î (–¥–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ, –Ω–∞–π—Ç–∏ user_id –∏ —Ç.–¥.)                                     |
| `routes/search.py`        | Endpoint `/search` ‚Äî –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ñ–æ—Ç–æ, –∏–∑–≤–ª–µ–∫–∞–µ—Ç embedding, –∏—â–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è               |
| `routes/admin.py`         | Endpoint `/admin/upload_batch` ‚Äî –¥–æ–±–∞–≤–ª—è–µ—Ç –±–∞—Ç—á –≤ –æ—á–µ—Ä–µ–¥—å                               |
| `services/embeddings.py`  | –û–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ InsightFace/DeepFace –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–∞                               |
| `services/faiss_index.py` | –ú–µ—Ç–æ–¥—ã —Ä–∞–±–æ—Ç—ã —Å –∏–Ω–¥–µ–∫—Å–æ–º FAISS (load, search, update)                                   |
| `services/storage.py`     | –ü—É—Ç—å –∫ —Ñ–æ—Ç–æ, —Å–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–æ–≤, –º–∏–Ω–∏–∞—Ç—é—Ä—ã                                              |
| `workers/enqueue.py`      | –ö–ª–∞–¥—ë—Ç –∑–∞–¥–∞–Ω–∏–µ –≤ Redis Queue (–¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–æ–≤—ã–º –≤–æ—Ä–∫–µ—Ä–æ–º)                             |


### `ml_worker/` ‚Äî ML-–æ–±—Ä–∞–±–æ—Ç–∫–∞
- –ü–æ–ª—É—á–∞–µ—Ç –∑–∞–¥–∞—á–∏ –∏–∑ –æ—á–µ—Ä–µ–¥–∏ (Redis).  
- –î–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç –ª–∏—Ü–∞ ‚Üí –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç ‚Üí –∏–∑–≤–ª–µ–∫–∞–µ—Ç —ç–º–±–µ–¥–¥–∏–Ω–≥–∏.  
- –û—Ü–µ–Ω–∏–≤–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ —Å–Ω–∏–º–∫–æ–≤.  
- –ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç –ø–æ—Ö–æ–∂–∏–µ –ª–∏—Ü–∞ –≤ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è).  
- –û–±–Ω–æ–≤–ª—è–µ—Ç —Ç–∞–±–ª–∏—Ü—ã –≤ –ë–î –∏ –∏–Ω–¥–µ–∫—Å FAISS.

| –§–∞–π–ª             | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç                                                               |
| ---------------- | ------------------------------------------------------------------------ |
| `worker.py`      | –°–ª—É—à–∞–µ—Ç Redis-–æ—á–µ—Ä–µ–¥—å –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–µ –±–∞—Ç—á–∏                         |
| `detector.py`    | –ù–∞—Ö–æ–¥–∏—Ç –ª–∏—Ü–∞ (RetinaFace –∏–ª–∏ MTCNN)                                      |
| `aligner.py`     | –î–µ–ª–∞–µ—Ç –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ª–∏—Ü–∞ (–ø–æ –∫–ª—é—á–µ–≤—ã–º —Ç–æ—á–∫–∞–º)                            |
| `embedder.py`    | –°—á–∏—Ç–∞–µ—Ç —ç–º–±–µ–¥–¥–∏–Ω–≥ —Å –ø–æ–º–æ—â—å—é ArcFace/AdaFace                              |
| `quality.py`     | –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–µ–∑–∫–æ—Å—Ç—å, –ø–æ–≤–æ—Ä–æ—Ç, —Ä–∞–∑–º–µ—Ä –ª–∏—Ü–∞                                 |
| `clusterizer.py` | –ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç –ø–æ—Ö–æ–∂–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –≤ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (DBSCAN)             |
| `updater.py`     | –û–±–Ω–æ–≤–ª—è–µ—Ç –ë–î (–¥–æ–±–∞–≤–ª—è–µ—Ç users, faces, user_photos) –∏ FAISS               |
| `utils/`         | –£—Ç–∏–ª–∏—Ç—ã ‚Äî –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ–∫—Ç–æ—Ä–æ–≤ |


### `bot/` ‚Äî Telegram-–±–æ—Ç
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Ñ–æ—Ç–æ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.  
- –í—ã–∑—ã–≤–∞–µ—Ç `/search` API.  
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.  
- –ú–æ–∂–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –ø–µ—Ä–µ—Å–ª–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–æ—Ç–æ –¥–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è.

| –§–∞–π–ª            | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç                                                         |
| --------------- | ------------------------------------------------------------------ |
| `main.py`       | –ó–∞–ø—É—Å–∫ aiogram-–±–æ—Ç–∞                                                |
| `handlers.py`   | –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π: –ø—Ä–∏—ë–º —Ñ–æ—Ç–æ, –∑–∞–ø—Ä–æ—Å –∫ API, –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ |
| `api_client.py` | –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å REST API (–∑–∞–ø—Ä–æ—Å `/search`)                       |
| `keyboards.py`  | Inline-–∫–Ω–æ–ø–∫–∏ –∏ –º–µ–Ω—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, ‚Äú–ó–∞–≥—Ä—É–∑–∏—Ç—å –µ—â—ë —Ñ–æ—Ç–æ‚Äù)              |


### `scripts/` ‚Äî –£—Ç–∏–ª–∏—Ç—ã
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏, –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–µ–π –∏ –º–∏–≥—Ä–∞—Ü–∏—è–º–∏.  
- –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ —Å –≤–Ω–µ—à–Ω–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (–Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫).  
- –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è FAISS.

| –§–∞–π–ª                  | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç                                           |
| --------------------- | ---------------------------------------------------- |
| `init_db.py`          | –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü (—á–µ—Ä–µ–∑ SQLAlchemy/Alembic)           |
| `rebuild_faiss.py`    | –ü–µ—Ä–µ—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç FAISS –∏–Ω–¥–µ–∫—Å –∏–∑ –ë–î –∑–∞–Ω–æ–≤–æ              |
| `load_from_yadisk.py` | –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫—É API, —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤    |
| `import_batch.py`     | –§–æ—Ä–º–∏—Ä—É–µ—Ç batch –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–¥–∞—á—É –≤ –æ—á–µ—Ä–µ–¥—å –≤–æ—Ä–∫–µ—Ä–∞ |

---

## üß± –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

| –¢–∞–±–ª–∏—Ü–∞ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|----------|------------|
| `photos` | –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ñ–æ—Ç–æ, –ø—É—Ç–∏ –∫ –Ω–∏–º, –¥–∞—Ç–∞ –∑–∞–≥—Ä—É–∑–∫–∏ |
| `faces` | –û—Ç–¥–µ–ª—å–Ω—ã–µ –ª–∏—Ü–∞ –Ω–∞ —Ñ–æ—Ç–æ, –∏—Ö —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –∏ user_id |
| `users` | –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (—É—Å—Ä–µ–¥–Ω—ë–Ω–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏) |
| `user_photos` | –°–≤—è–∑—å `user_id ‚Üî photo_id` |
| `upload_batches` | –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏ (–±–∞—Ç—á–∏ –∏–∑ –Ø.–î–∏—Å–∫–∞ –∏ —Ç.–ø.) |

---

## üì¶ –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (–ø—Ä–∏–º–µ—Ä —Å—Ü–µ–Ω–∞—Ä–∏—è)

1. **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä** –≤—ã–∑—ã–≤–∞–µ—Ç `POST /admin/upload_batch` ‚Üí FastAPI –∫–ª–∞–¥—ë—Ç –∑–∞–¥–∞—á—É –≤ Redis.  
2. **ML-–≤–æ—Ä–∫–µ—Ä** –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–¥–∞—á—É, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ —Ñ–æ—Ç–æ:
   –∏—â–µ—Ç –ª–∏—Ü–∞ ‚Üí –¥–µ–ª–∞–µ—Ç —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ ‚Üí –∫–ª–∞—Å—Ç–µ—Ä–∏–∑—É–µ—Ç –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º ‚Üí –æ–±–Ω–æ–≤–ª—è–µ—Ç –ë–î + FAISS.  
3. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å Telegram** –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–æ—Ç–æ ‚Üí –±–æ—Ç –≤—ã–∑—ã–≤–∞–µ—Ç `/search`.
4. **API** –∏–∑–≤–ª–µ–∫–∞–µ—Ç —ç–º–±–µ–¥–¥–∏–Ω–≥, –∏—â–µ—Ç –±–ª–∏–∂–∞–π—à–∏–π `user_id` –≤ FAISS, –¥–æ—Å—Ç–∞—ë—Ç –ø—É—Ç–∏ —Ñ–æ—Ç–æ –∏–∑ –ë–î.
5. **–ë–æ—Ç** –ø–æ —ç—Ç–∏–º –ø—É—Ç—è–º –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤—Å–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —Ñ–æ—Ç–æ.

---

## üöÄ –ß—Ç–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ—Ç–æ–º

- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (Redis).
- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, FastAPI + AdminJS).
- –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä—É—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è user_id.
- –õ–æ–≥–∏ –∏ –º–µ—Ç—Ä–∏–∫–∏ (Prometheus + Grafana).
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–æ–æ–±—É—á–∞—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –Ω–∞ —Å–≤–æ—ë–º –¥–∞—Ç–∞—Å–µ—Ç–µ.

---

¬© 2025 PhotoFinder ‚Äî —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ª—é–¥–µ–π –ø–æ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º.







